
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Cleveland eHealth ‚Äî Global Clinic Radio Network</title>
<style>
  html, body { margin:0; padding:0; height:100%; overflow:hidden; background:#000; color:white; font-family:system-ui, Arial, sans-serif; }
  #header { position:absolute; top:10px; left:20px; z-index:10; background:rgba(0,0,0,0.4); padding:10px 14px; border-radius:8px; font-size:16px; color:#aee4ff; }
  #infoBox { position:absolute; bottom:20px; left:20px; background:rgba(0,0,0,0.55); padding:10px 14px; border-radius:8px; color:#fff; font-size:14px; max-width:320px; line-height:1.4; }
  #globeViz { width:100%; height:100%; cursor:grab; }
</style>
</head>
<body>
<div id="header">üåç Cleveland eHealth ‚Äî Global Clinic Radio Network</div>
<div id="globeViz"></div>
<div id="infoBox">Click a clinic to view info and play stream.</div>

<script src="https://unpkg.com/three@0.149.0/build/three.min.js"></script>
<script src="https://unpkg.com/three-globe"></script>
<script>
const clinics = [{"id": "CL001", "clinic": "Clinic 1", "city": "Coimbatore", "lat": 10.742077, "lon": 77.076647, "status": "Active"}, {"id": "CL002", "clinic": "Clinic 2", "city": "Patna", "lat": 25.459112, "lon": 85.36103, "status": "Active"}, {"id": "CL003", "clinic": "Clinic 3", "city": "Coimbatore", "lat": 11.063045, "lon": 76.676549, "status": "Active"}, {"id": "CL004", "clinic": "Clinic 4", "city": "Patna", "lat": 25.852451, "lon": 85.233025, "status": "Active"}, {"id": "CL005", "clinic": "Clinic 5", "city": "Bengaluru", "lat": 12.688217, "lon": 77.295246, "status": "Active"}, {"id": "CL006", "clinic": "Clinic 6", "city": "Nagpur", "lat": 21.016164, "lon": 79.254178, "status": "Active"}, {"id": "CL007", "clinic": "Clinic 7", "city": "Jaipur", "lat": 27.192903, "lon": 76.065583, "status": "Active"}, {"id": "CL008", "clinic": "Clinic 8", "city": "Indore", "lat": 22.870484, "lon": 75.765092, "status": "Active"}, {"id": "CL009", "clinic": "Clinic 9", "city": "Coimbatore", "lat": 10.951084, "lon": 76.986709, "status": "Active"}, {"id": "CL010", "clinic": "Clinic 10", "city": "Jaipur", "lat": 27.172224, "lon": 75.657197, "status": "Active"}, {"id": "CL011", "clinic": "Clinic 11", "city": "Bengaluru", "lat": 12.803002, "lon": 77.340386, "status": "Inactive"}, {"id": "CL012", "clinic": "Clinic 12", "city": "Nagpur", "lat": 21.06826, "lon": 78.879328, "status": "Inactive"}, {"id": "CL013", "clinic": "Clinic 13", "city": "Indore", "lat": 22.723863, "lon": 75.856264, "status": "Inactive"}, {"id": "CL014", "clinic": "Clinic 14", "city": "Lucknow", "lat": 26.594479, "lon": 81.170849, "status": "Inactive"}, {"id": "CL015", "clinic": "Clinic 15", "city": "Kolkata", "lat": 22.824101, "lon": 88.551686, "status": "Inactive"}, {"id": "CL016", "clinic": "Clinic 16", "city": "Chennai", "lat": 13.253602, "lon": 80.456612, "status": "Inactive"}, {"id": "CL017", "clinic": "Clinic 17", "city": "Chennai", "lat": 13.030542, "lon": 80.411486, "status": "Inactive"}, {"id": "CL018", "clinic": "Clinic 18", "city": "Vadodara", "lat": 22.606768, "lon": 72.934209, "status": "Inactive"}, {"id": "CL019", "clinic": "Clinic 19", "city": "Bhopal", "lat": 23.390727, "lon": 77.673603, "status": "Inactive"}, {"id": "CL020", "clinic": "Clinic 20", "city": "Nagpur", "lat": 21.200183, "lon": 78.832162, "status": "Inactive"}, {"id": "CL021", "clinic": "Clinic 21", "city": "Goa", "lat": 15.365499, "lon": 73.993963, "status": "Inactive"}, {"id": "CL022", "clinic": "Clinic 22", "city": "Mumbai", "lat": 19.181135, "lon": 72.729297, "status": "Inactive"}, {"id": "CL023", "clinic": "Clinic 23", "city": "Coimbatore", "lat": 10.979702, "lon": 77.125567, "status": "Inactive"}, {"id": "CL024", "clinic": "Clinic 24", "city": "Indore", "lat": 22.804795, "lon": 75.977068, "status": "Inactive"}, {"id": "CL025", "clinic": "Clinic 25", "city": "Goa", "lat": 15.299505, "lon": 74.187844, "status": "Inactive"}, {"id": "CL026", "clinic": "Clinic 26", "city": "Vishakhapatnam", "lat": 17.575645, "lon": 83.46478, "status": "Inactive"}, {"id": "CL027", "clinic": "Clinic 27", "city": "Kolkata", "lat": 22.816789, "lon": 88.128877, "status": "Inactive"}, {"id": "CL028", "clinic": "Clinic 28", "city": "Surat", "lat": 21.081803, "lon": 72.919491, "status": "Inactive"}, {"id": "CL029", "clinic": "Clinic 29", "city": "Vadodara", "lat": 22.177022, "lon": 73.354356, "status": "Inactive"}, {"id": "CL030", "clinic": "Clinic 30", "city": "Vadodara", "lat": 22.117491, "lon": 73.230063, "status": "Inactive"}, {"id": "CL031", "clinic": "Clinic 31", "city": "Hyderabad", "lat": 17.507027, "lon": 78.696548, "status": "Inactive"}, {"id": "CL032", "clinic": "Clinic 32", "city": "Coimbatore", "lat": 10.898351, "lon": 76.661314, "status": "Inactive"}, {"id": "CL033", "clinic": "Clinic 33", "city": "Pune", "lat": 18.726285, "lon": 74.03094, "status": "Inactive"}, {"id": "CL034", "clinic": "Clinic 34", "city": "Ahmedabad", "lat": 23.31518, "lon": 72.808919, "status": "Inactive"}, {"id": "CL035", "clinic": "Clinic 35", "city": "Surat", "lat": 20.923645, "lon": 72.579456, "status": "Inactive"}, {"id": "CL036", "clinic": "Clinic 36", "city": "Ahmedabad", "lat": 22.77398, "lon": 72.496919, "status": "Inactive"}, {"id": "CL037", "clinic": "Clinic 37", "city": "Pune", "lat": 18.237781, "lon": 73.910841, "status": "Inactive"}, {"id": "CL038", "clinic": "Clinic 38", "city": "Vadodara", "lat": 22.549164, "lon": 72.954745, "status": "Inactive"}, {"id": "CL039", "clinic": "Clinic 39", "city": "Mumbai", "lat": 18.985421, "lon": 73.047422, "status": "Inactive"}, {"id": "CL040", "clinic": "Clinic 40", "city": "Jaipur", "lat": 26.778834, "lon": 75.618114, "status": "Inactive"}, {"id": "CL041", "clinic": "Clinic 41", "city": "Delhi", "lat": 28.844436, "lon": 77.196118, "status": "Inactive"}, {"id": "CL042", "clinic": "Clinic 42", "city": "Chennai", "lat": 13.374465, "lon": 80.375734, "status": "Inactive"}, {"id": "CL043", "clinic": "Clinic 43", "city": "Coimbatore", "lat": 10.753048, "lon": 76.889665, "status": "Inactive"}, {"id": "CL044", "clinic": "Clinic 44", "city": "Lucknow", "lat": 26.875184, "lon": 80.713756, "status": "Inactive"}, {"id": "CL045", "clinic": "Clinic 45", "city": "Jaipur", "lat": 26.741662, "lon": 75.572845, "status": "Inactive"}, {"id": "CL046", "clinic": "Clinic 46", "city": "Kochi", "lat": 9.727968, "lon": 76.059771, "status": "Inactive"}, {"id": "CL047", "clinic": "Clinic 47", "city": "Goa", "lat": 15.185001, "lon": 74.115403, "status": "Inactive"}, {"id": "CL048", "clinic": "Clinic 48", "city": "Indore", "lat": 22.706115, "lon": 76.057694, "status": "Inactive"}, {"id": "CL049", "clinic": "Clinic 49", "city": "Jaipur", "lat": 26.898762, "lon": 76.006221, "status": "Inactive"}, {"id": "CL050", "clinic": "Clinic 50", "city": "Patna", "lat": 25.890853, "lon": 85.072661, "status": "Inactive"}, {"id": "CL051", "clinic": "Clinic 51", "city": "Vishakhapatnam", "lat": 17.963138, "lon": 83.460547, "status": "Inactive"}, {"id": "CL052", "clinic": "Clinic 52", "city": "Lucknow", "lat": 26.554261, "lon": 80.835194, "status": "Inactive"}, {"id": "CL053", "clinic": "Clinic 53", "city": "Delhi", "lat": 28.576846, "lon": 77.324699, "status": "Inactive"}, {"id": "CL054", "clinic": "Clinic 54", "city": "Coimbatore", "lat": 11.212185, "lon": 77.111806, "status": "Inactive"}, {"id": "CL055", "clinic": "Clinic 55", "city": "Mumbai", "lat": 18.891367, "lon": 72.717604, "status": "Inactive"}, {"id": "CL056", "clinic": "Clinic 56", "city": "Lucknow", "lat": 27.058411, "lon": 80.824996, "status": "Inactive"}, {"id": "CL057", "clinic": "Clinic 57", "city": "Delhi", "lat": 29.001673, "lon": 76.84536, "status": "Inactive"}, {"id": "CL058", "clinic": "Clinic 58", "city": "Jaipur", "lat": 26.723747, "lon": 75.501122, "status": "Inactive"}, {"id": "CL059", "clinic": "Clinic 59", "city": "Indore", "lat": 22.868481, "lon": 76.013888, "status": "Inactive"}, {"id": "CL060", "clinic": "Clinic 60", "city": "Patna", "lat": 25.575083, "lon": 85.357453, "status": "Inactive"}, {"id": "CL061", "clinic": "Clinic 61", "city": "Bengaluru", "lat": 12.930181, "lon": 77.384705, "status": "Inactive"}, {"id": "CL062", "clinic": "Clinic 62", "city": "Goa", "lat": 15.163447, "lon": 74.190968, "status": "Inactive"}, {"id": "CL063", "clinic": "Clinic 63", "city": "Chennai", "lat": 13.131175, "lon": 80.147965, "status": "Inactive"}, {"id": "CL064", "clinic": "Clinic 64", "city": "Kolkata", "lat": 22.604312, "lon": 88.218017, "status": "Inactive"}, {"id": "CL065", "clinic": "Clinic 65", "city": "Mumbai", "lat": 18.810704, "lon": 72.712794, "status": "Inactive"}, {"id": "CL066", "clinic": "Clinic 66", "city": "Lucknow", "lat": 26.705068, "lon": 80.7361, "status": "Inactive"}, {"id": "CL067", "clinic": "Clinic 67", "city": "Patna", "lat": 25.672734, "lon": 84.90464, "status": "Inactive"}, {"id": "CL068", "clinic": "Clinic 68", "city": "Goa", "lat": 15.047234, "lon": 74.023083, "status": "Inactive"}, {"id": "CL069", "clinic": "Clinic 69", "city": "Kolkata", "lat": 22.780735, "lon": 88.20449, "status": "Inactive"}, {"id": "CL070", "clinic": "Clinic 70", "city": "Surat", "lat": 20.961654, "lon": 72.783658, "status": "Inactive"}, {"id": "CL071", "clinic": "Clinic 71", "city": "Ahmedabad", "lat": 23.273807, "lon": 72.479105, "status": "Inactive"}, {"id": "CL072", "clinic": "Clinic 72", "city": "Surat", "lat": 21.403035, "lon": 73.087188, "status": "Inactive"}, {"id": "CL073", "clinic": "Clinic 73", "city": "Surat", "lat": 21.322009, "lon": 73.092637, "status": "Inactive"}, {"id": "CL074", "clinic": "Clinic 74", "city": "Vishakhapatnam", "lat": 17.846416, "lon": 83.475186, "status": "Inactive"}, {"id": "CL075", "clinic": "Clinic 75", "city": "Vishakhapatnam", "lat": 17.526197, "lon": 82.973753, "status": "Inactive"}];
const STREAM_URL = "https://api.allorigins.win/raw?url=https://cast4.my-control-panel.com/proxy/demo4usv/live";

// Set up globe
const container = document.getElementById('globeViz');
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
camera.position.z = 250;

const renderer = new THREE.WebGLRenderer({ antialias:true, alpha:true });
renderer.setSize(window.innerWidth, window.innerHeight);
container.appendChild(renderer.domElement);

const globe = new ThreeGlobe()
  .globeImageUrl('https://unpkg.com/three-globe/example/img/earth-night.jpg')
  .bumpImageUrl('https://unpkg.com/three-globe/example/img/earth-topology.png')
  .pointsData(clinics.map(c => ({ lat:c.lat, lng:c.lon, size:0.8, color:c.status==='Active'?'#00ff88':'#ff4444', id:c.id, city:c.city, status:c.status, clinic:c.clinic })))
  .pointAltitude(0.02)
  .pointColor('color');

scene.add(globe);

// lighting
scene.add(new THREE.AmbientLight(0xbbbbbb));
const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
dirLight.position.set(1, 1, 1);
scene.add(dirLight);

// rotation control
let autoRotate = true;
function animate() {
  if (autoRotate) globe.rotation.y += 0.0015;
  renderer.render(scene, camera);
  requestAnimationFrame(animate);
}
animate();

// pause rotation while dragging
let isDragging = false;
let previousMousePosition = { x:0, y:0 };
renderer.domElement.addEventListener('mousedown', function(e){ isDragging = true; autoRotate = false; });
renderer.domElement.addEventListener('mouseup', function(e){ isDragging = false; autoRotate = true; });
renderer.domElement.addEventListener('mousemove', function(e){
  if(isDragging){
    const deltaMove = { x: e.offsetX - previousMousePosition.x, y: e.offsetY - previousMousePosition.y };
    globe.rotation.y += deltaMove.x * 0.005;
  }
  previousMousePosition = { x: e.offsetX, y: e.offsetY };
});

window.addEventListener('resize', ()=>{ renderer.setSize(window.innerWidth, window.innerHeight); camera.aspect = window.innerWidth/window.innerHeight; camera.updateProjectionMatrix(); });

// Audio setup (instant play on click)
let audioEnabled = false;
const audio = new Audio();
audio.crossOrigin = "anonymous";
audio.preload = "none";
audio.loop = true;
audio.volume = 1.0;

document.body.addEventListener('click', function enableAudioOnce(){ if(!audioEnabled){ audioEnabled = true; try{ audio.play().then(()=>{ audio.pause(); audio.currentTime = 0; }).catch(()=>{}); }catch(e){} document.body.removeEventListener('click', enableAudioOnce); } });

// raycasting for clicks
const raycaster = new THREE.Raycaster();
const mouse = new THREE.Vector2();
renderer.domElement.addEventListener('click', function(event){
  const rect = renderer.domElement.getBoundingClientRect();
  mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
  mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
  raycaster.setFromCamera(mouse, camera);
  const intersects = raycaster.intersectObjects(globe.pointsObjects(), true);
  if(intersects.length>0){
    const point = intersects[0].object.userData || intersects[0].object;
    // find clinic matching lat/lng (approx)
    const clinic = clinics.find(c => Math.abs(c.lat - point.lat) < 0.5 && Math.abs(c.lon - point.lng) < 0.5);
    if(clinic){
      const info = document.getElementById('infoBox');
      info.innerHTML = "<strong>" + clinic.clinic + "</strong><br>City: " + clinic.city + "<br>Status: " + clinic.status;
      if(clinic.status === 'Active' && audioEnabled){
        audio.src = STREAM_URL;
        audio.play().catch(()=>{});
      } else {
        try{ audio.pause(); audio.currentTime = 0; }catch(e){}
      }
    }
  }
});
</script>
</body>
</html>
